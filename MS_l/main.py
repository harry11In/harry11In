import pystray
import PIL.Image
import io
import tkinter as tk
import base64
from configer import ConfigApp
from starter import creatloclist as start

# Load the image into a variable
image_data = """
    <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9wG+/XZHP7b9TTOsBoDRox392A4j9BYgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAAAeAgAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAAAPAQACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAC9VwMx7OT4H8bP7PzQgae3m3eMAP7y/T8X5Tf3fPFbu008treAxa8982Zr/sml733sLROPDMDkk2/8162zT79h5FEBmPvMP6+7XXz9l2YeE4AvHb1hQfHSXw09HgC//f1Ni+pfXTb1WADMfHONhUPfNfVYAPz0wlpLf7Bg7HEAKH685uKpXxl7HADeOrn28p8YexwA/thm+bHL5h4FgKPtVrxt7jEAWPx7uzVOBUQBYGyl3ZoRc48BwJUO1gBQoS53sAaACjXbwRoAKtTuDtYAUKHu7mANABXqrg7W9E4FALfbh+9ot2Z/H2z9FgBut/c91m7NIa/8MQBIDrbb54PmHgWA59osP7LT3KMA8NE27wEvGXscAJKvrLl0z7PGHgmAzx9Ya+l3thl7JAAGXl9j9z75oqnHAiD5+Ms3Ldr1Q0OPB0Dy2hduWHDn7/YZekQAtv7o+etu7/zNJ8w8JgDJwC9ev/M/tw4fe8rI4wKQJF/+xzfuaX335M/+dJ+J3/gMqf4u3vfqK38bHt/1wEf29tNWFwCsX9sff7zvttnVQAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAA8BAAIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAAAeAgAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQACofVu6dD87dr3HX5i81tm/O129mczX0lp+bKFaADYMVqUAFONZVkvHGl28ywEvgr3RdJ7leTbX9fsFYNOrDzef9tmpTbp3ADazK2H0taXN3AQANqeVoTD7C5u/IQB0vfNh9MdXemRrAOhii0NpXkuv9NQ2AdCdToWn/XC99zYMgI1uLk9redazpysA2Lgao+FpP1709EYCsCFNhtHnC32wpQCsc6sn0+bsz/bN9gKwfl0KT/vBa/210QCsR9fK0zrv9OOmA3CbnQ2jP7Hat9sPQMcthMv26WSf7wUAHVRets9GG1XYFwD+v2byLMvz2ersEAC3Wn0kPO0nqrZbANxC75aX7RcruW8A/M9WjofZn6/wHgLQrgvlZfvlqu8mADe3NNh7l+0B6E6nw69l9+JlewA2urnytM50dPsNQFKUl+3Hijj3Pm4AU+Vl+/mYH4JYAdRPhNmf8foXIYC+vGwPwHq0XF62v2jqEQI4V57WWTXw+AAsDIb/31016vgAFBPhaT/SMOX4AMyUn7afNd/4ADRGwq9lnyqMNj4AV8vTOouGGh+AlfK0zjnjjA9AcTGMfmjZJDvs30dVWnehwCIFAAAAAElFTkSuQmCC>
"""

# Decode base64 and create a PIL Image
image = PIL.Image.open(io.BytesIO(base64.b64decode(image_data)))

def start_app():
    start()

def quit_app(icon, item):
    icon.stop()

def open_config():
    root1 = tk.Tk()
    app = ConfigApp(root1)
    root1.mainloop()

# Create a system tray icon and menu using the loaded image
icon = pystray.Icon("Neural", image, menu=pystray.Menu(
    pystray.MenuItem('Start', start_app),
    pystray.MenuItem('Settings', open_config),
    pystray.MenuItem('Exit', quit_app)
))

icon.run()
